FROM python:3.11-slim

WORKDIR /app

RUN apt-get update && apt-get install -y --no-install-recommends \
    curl ca-certificates && \
    rm -rf /var/lib/apt/lists/*

COPY requirements_oss.txt .
RUN pip install --no-cache-dir -r requirements_oss.txt

COPY model/artifacts/ ./model/artifacts/
COPY LLM/ ./LLM/
COPY app_oss_main.py ./app_oss_main.py
COPY .env ./.env
COPY data/department.txt ./data/department.txt
COPY data/sub_model_data/ ./data/sub_model_data/

EXPOSE 8010
CMD ["uvicorn", "app_oss_main:app", "--host", "0.0.0.0", "--port", "8010"]